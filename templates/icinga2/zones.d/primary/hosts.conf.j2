{% for host in icinga2_zones.primary.endpoints %}
object Host "{{ host }}" {
    import "agent-host"
    address6 = "{{ hostvars[host].ansible_default_ipv6.address }}"

    vars.os_type = "Debian"
}

{% endfor %}
object Host "virgil.altenforst.de" {
    import "generic-host"

    check_interval = 10m
    retry_interval = 2m

    vars.http_vhosts = {
        "web" = {
            "address" = "$address$",
            "vhost" = "www.altenforst.de",
            "url" = "/"
        }
    }

    vars.ssl_cert_checks = {
        "web" = {
            "port" = "443",
            "protocol" = "https",
            "cn" = ["altenforst.de", "www.altenforst.de"],
            "sni" = "altenforst.de",
            "altnames" = true
        }
        "web_listen" = {
            "port" = "443",
            "protocol" = "https",
            "cn" = "listen.altenforst.de",
            "sni" = "listen.altenforst.de",
            "altnames" = true
        }
        "web_otp" = {
            "port" = "443",
            "protocol" = "https",
            "cn" = "otp.altenforst.de",
            "sni" = "otp.altenforst.de",
            "altnames" = true
        }
    }
}
